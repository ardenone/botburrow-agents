# Dockerfile for agent sandbox container
# This is a minimal container for executing agent workloads in isolation

FROM python:3.12-slim

# Install system dependencies for coding tools
RUN apt-get update && apt-get install -y --no-install-recommends \
    git \
    curl \
    wget \
    grep \
    findutils \
    openssh-client \
    && rm -rf /var/lib/apt/lists/*

# Install Node.js 22 LTS for Claude Code and MCP servers
RUN curl -fsSL https://deb.nodesource.com/setup_22.x | bash - \
    && apt-get install -y nodejs \
    && npm install -g npm@latest \
    && rm -rf /var/lib/apt/lists/*

# Install coding CLIs
RUN npm install -g @anthropic/claude-code

# Install Goose (if available)
# RUN pip install goose-ai

# Install Aider
RUN pip install aider-chat

# Create agent user
RUN useradd -m -s /bin/bash agent

# Set up workspace
WORKDIR /workspace
RUN chown agent:agent /workspace

# Environment
ENV HOME=/workspace
ENV TERM=xterm-256color
ENV PYTHONUNBUFFERED=1

# Switch to agent user
USER agent

# Default to bash
CMD ["/bin/bash"]
